(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;b=a.WebSharper=a.WebSharper||{};c=b.AspNetCore=b.AspNetCore||{};d=c.Tests=c.Tests||{};e=d.WebSocketClient=d.WebSocketClient||{};f=d.Website=d.Website||{};g=f.SomeRecord=f.SomeRecord||{};h=f.Client=f.Client||{};i=a.ClientServer_JsonDecoder=a.ClientServer_JsonDecoder||{};j=a.ClientServer_JsonEncoder=a.ClientServer_JsonEncoder||{};k=a.ClientServer_GeneratedPrintf=a.ClientServer_GeneratedPrintf||{};l=a.ClientServer_Templates=a.ClientServer_Templates||{};m=b&&b.UI;n=m&&m.Doc;o=m&&m.AttrProxy;p=b&&b.Arrays;q=b&&b.Concurrency;r=b&&b.Unchecked;s=b&&b.JavaScript;t=s&&s.Promise;u=b&&b.Utils;v=a.console;w=m&&m.Var$1;x=c&&c.WebSocket;y=x&&x.Client;z=y&&y.WithEncoding;A=a.JSON;B=m&&m.Templating;C=B&&B.Runtime;D=C&&C.Server;E=D&&D.ProviderBuilder;F=D&&D.Handler;G=D&&D.TemplateInstance;H=b&&b.ClientSideJson;I=H&&H.Provider;J=m&&m.Client;K=J&&J.Templates;e.WebSocketTest$575$25=a.id;e.WebSocketTest$570$26=a.id;e.WebSocketTest$560$26=a.id;e.WebSocketTest$547$26=a.id;e.WebSocketTest$534$26=a.id;e.WebSocketTest$520$26=a.id;e.WebSocketTest$507$30=a.id;e.WebSocketTest$259$22=function(L,M){return function(){return function(){return L(M);};};};e.WebSocketTest$239$22=function(L,M){return function(){return function(){return L(M);};};};e.WebSocketTest$214$22=function(L,M){return function(){return function(){return L(M);};};};e.WebSocketTest=function(L){var M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6;function _7(bh){M.$0.Post({$:0,$0:bh});}function _8(bh,bi){var bj,bk,bl,bm,bn,bo;bj=n.Element("button",[o.Create("class","retweet-handler btn btn-info"),o.HandlerImpl("click",function(){return function(){return _7(bi);};})],[n.TextNode("Retweet!")]);bk=self.document.createElement("div");bl=self.document.createElement("div");bm=self.document.createElement("div").appendChild(bj.elt);bl.innerHTML=(bn=[bh,bi],"\n            <div class=\"post\" style=\"display:flex;justify-content:center\"><div class=\"post__body\">"+(p.get(bn,0)==null?"":a.String(p.get(bn,0)))+("</div><div style=\"margin-left:10px\">"+(p.get(bn,1)==null?"":a.String(p.get(bn,1))))+"</div><div>");bo=bk.appendChild(bl);bo.appendChild(bm);R.elt.appendChild(bo);}function _9(bh,bi){var bj,bk,bl,bm,bn,bo;bj=n.Element("button",[o.Create("class","retweet-handler btn btn-info"),o.HandlerImpl("click",function(){return function(){return _7(bi);};})],[n.TextNode("Retweet!")]);bk=self.document.createElement("div");bl=self.document.createElement("div");bm=self.document.createElement("div").appendChild(bj.elt);bl.innerHTML=(bn=[T,bh,bi],"<div style=\"display:flex;justify-content:center\"><div>Query for "+(p.get(bn,0)==null?"":a.String(p.get(bn,0)))+(": "+(p.get(bn,1)==null?"":a.String(p.get(bn,1))))+("</div><div style=\"margin-left:10px\">"+(p.get(bn,2)==null?"":a.String(p.get(bn,2))))+"</div><div>");bo=bk.appendChild(bl);bo.appendChild(bm);S.elt.appendChild(bo);}function _(bh,bi){var bj,bk,bl,bm,bn,bo;bj=n.Element("button",[o.Create("class","retweet-handler btn btn-info"),o.HandlerImpl("click",function(){return function(){return _7(bi);};})],[n.TextNode("Retweet!")]);bk=self.document.createElement("div");bl=self.document.createElement("div");bm=self.document.createElement("div").appendChild(bj.elt);bl.innerHTML=(bn=[bh,bi],"<div style=\"display:flex;justify-content:center\"><div>While you were away you missed: "+(p.get(bn,0)==null?"":a.String(p.get(bn,0)))+("</div><div style=\"margin-left:10px\">"+(p.get(bn,1)==null?"":a.String(p.get(bn,1))))+"</div><div>");bo=bk.appendChild(bl);bo.appendChild(bm);R.elt.appendChild(bo);}function $(){var bh,bi,bj,bk,bl,bm,bn,bo,bp;bh=self.document.getElementById("register");bh.innerHTML="Account Registered";bh.setAttribute("disabled","true");U.Set("Welcome to Twitter, @"+U.Get());self.document.getElementById("register-form").setAttribute("disabled","true");self.document.getElementById("logout").removeAttribute("disabled");bi=self.document.getElementById("tweetbox");bj=self.document.getElementById("subscribebox");bk=self.document.getElementById("unsubscribebox");bl=self.document.getElementById("querybox");bm=self.document.getElementById("tweetbtn");bn=self.document.getElementById("subscribebtn");bo=self.document.getElementById("unsubscribebtn");bp=self.document.getElementById("querybtn");bi.removeAttribute("disabled");bj.removeAttribute("disabled");bk.removeAttribute("disabled");bl.removeAttribute("disabled");bm.removeAttribute("disabled");bn.removeAttribute("disabled");bo.removeAttribute("disabled");bp.removeAttribute("disabled");}function ba(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){return q.Combine(r.Equals(M,null)?(t.OfAsync(V).then(function(bk){M={$:1,$0:bk};}),q.Zero()):q.Zero(),q.Delay(function(){((function(bk){return function(bl){return bk("Tweeting "+u.toSafe(bl));};}(function(bk){v.log(bk);}))(Z.Get()));M.$0.Post({$:0,$0:Z.Get()});Z.Set("");return q.Zero();}));})),null);}function bb(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){return q.Combine(r.Equals(M,null)?(t.OfAsync(V).then(function(bk){M={$:1,$0:bk};}),q.Zero()):q.Zero(),q.Delay(function(){((function(bk){return function(bl){return bk("Subscribing to "+u.toSafe(bl));};}(function(bk){v.log(bk);}))(_0.Get()));M.$0.Post({$:2,$0:_0.Get()});_0.Set("");return q.Zero();}));})),null);}function bc(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){return q.Combine(r.Equals(M,null)?(t.OfAsync(V).then(function(bk){M={$:1,$0:bk};}),q.Zero()):q.Zero(),q.Delay(function(){((function(bk){return function(bl){return bk("Unsubscribing to "+u.toSafe(bl));};}(function(bk){v.log(bk);}))(Y.Get()));M.$0.Post({$:3,$0:Y.Get()});Y.Set("");return q.Zero();}));})),null);}function bd(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){return q.Combine(r.Equals(M,null)?(t.OfAsync(V).then(function(bk){M={$:1,$0:bk};}),q.Zero()):q.Zero(),q.Delay(function(){((function(bk){return function(bl){return bk("Querying #"+u.toSafe(bl));};}(function(bk){v.log(bk);}))(_1.Get()));M.$0.Post({$:4,$0:_1.Get()});T=_1.Get();_1.Set("");return q.Zero();}));})),null);}function be(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){var bk,bl,bm,bn,bo,bp,bq,br,bs,bt;M.$0.Post({$:5});bk=self.document.getElementById("login");bl=self.document.getElementById("logout");bm=self.document.getElementById("tweetbox");bn=self.document.getElementById("subscribebox");bo=self.document.getElementById("unsubscribebox");bp=self.document.getElementById("querybox");bq=self.document.getElementById("tweetbtn");br=self.document.getElementById("subscribebtn");bs=self.document.getElementById("unsubscribebtn");bt=self.document.getElementById("querybtn");bm.removeAttribute("disabled");bn.removeAttribute("disabled");bo.removeAttribute("disabled");bp.removeAttribute("disabled");bq.removeAttribute("disabled");br.removeAttribute("disabled");bs.removeAttribute("disabled");bt.removeAttribute("disabled");bk.removeAttribute("style");bl.removeAttribute("style");bk.setAttribute("disabled","true");return q.Zero();})),null);}function bf(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){var bk,bl,bm,bn,bo,bp,bq,br,bs,bt;M.$0.Post({$:6});bk=self.document.getElementById("login");bl=self.document.getElementById("logout");bm=self.document.getElementById("tweetbox");bn=self.document.getElementById("subscribebox");bo=self.document.getElementById("unsubscribebox");bp=self.document.getElementById("querybox");bq=self.document.getElementById("tweetbtn");br=self.document.getElementById("subscribebtn");bs=self.document.getElementById("unsubscribebtn");bt=self.document.getElementById("querybtn");bm.setAttribute("disabled","true");bn.setAttribute("disabled","true");bo.setAttribute("disabled","true");bp.setAttribute("disabled","true");bq.setAttribute("disabled","true");br.setAttribute("disabled","true");bs.setAttribute("disabled","true");bt.setAttribute("disabled","true");bk.setAttribute("style","display:block");bl.setAttribute("style","display:none");return q.Zero();})),null);}function bg(bh,bi){var bj;return q.Start((bj=null,q.Delay(function(){return r.Equals(M,null)?(function(bk){return bk("Trying to connect.");}(function(bk){v.log(bk);}),t.OfAsync(V).then(function(bk){M={$:1,$0:bk};(function(bl){return bl("Registering");}(function(bl){v.log(bl);}));return M.$0.Post({$:1,$0:U.Get()});}),q.Zero()):(M.$0.Post({$:1,$0:U.Get()}),q.Zero());})),null);}M=null;N=n.Element("pre",[],[]);O=n.Element("div",[],[n.Element("h3",[],[n.TextNode("Twitter Feed")])]);P=n.Element("pre",[],[]);Q=n.Element("div",[],[n.Element("h3",[],[n.TextNode("Queried Requests")])]);R=n.Element("div",[],[]);S=n.Element("div",[],[]);T="";U=w.Create$1("");V=(W=null,q.Delay(function(){(function(bh){return bh("In here!");}(function(bh){v.log(bh);}));return z.ConnectStateful(function(bh){return A.stringify((j.j())(bh));},function(bh){return(i.j())(A.parse(bh));},L,function(){var bh;bh=null;return q.Delay(function(){return q.Return([0,function(bi){return function(bj){var bk;bk=null;return q.Delay(function(){var bl,bm,bn,bo,bp,bq,br,bs,bt;(function(bu){return bu("In in here here!");}(function(bu){v.log(bu);}));return q.Combine(bj.$==0?(bl=bj.$0,bl.$==1?(bm=bl.$0.split(","),((function(bu){return function(bv){return bu("ResponseMSG "+u.printArray(u.prettyPrint,bv));};}(function(bu){v.log(bu);}))(bm),bn=p.get(p.get(bm,0).split("\""),3),_8(p.get(p.get(bm,1).split("\""),3),bn),q.Zero())):bl.$==6?(bo=bl.$0.split(","),((function(bu){return function(bv){return bu("ResponseMSG "+u.printArray(u.prettyPrint,bv));};}(function(bu){v.log(bu);}))(bo),bp=p.get(p.get(bo,0).split("\""),3),_(p.get(p.get(bo,1).split("\""),3),bp),q.Zero())):bl.$==5?(bq=bl.$0,(br=bq.split(","),((function(bu){return function(bv){return bu("ResponseMSG "+u.prettyPrint(bv));};}(function(bu){v.log(bu);}))(bq),bs=p.get(p.get(br,0).split("\""),3),_9(p.get(p.get(br,1).split("\""),3),bs),q.Zero()))):bl.$==3?((function(bu){return function(bv){return bu("Success! "+u.toSafe(bv));};}(function(bu){v.log(bu);}))(bl.$0),q.Zero()):bl.$==4?(bt=bl.$0,((function(bu){return function(bv){return bu("Failure in home page! "+u.toSafe(bv));};}(function(bu){v.log(bu);}))(bt),a.alert(bt),q.Zero())):bl.$==2?($(),q.Zero()):bl.$==7?(function(bu){return bu("account retrieved from server");}(function(bu){v.log(bu);}),U.Set(bl.$0),q.Zero()):(function(bu){return bu("A message was sent back");}(function(bu){v.log(bu);}),q.Zero())):(function(bu){return bu("Failure");}(function(bu){v.log(bu);}),q.Zero()),q.Delay(function(){return q.Return(bi+1);}));});};}]);});});}));if(r.Equals(M,null))t.OfAsync(V).then(function(bh){var bi;M={$:1,$0:bh};(function(bj){return bj("Loading");}(function(bj){v.log(bj);}));return q.Start((bi=null,q.Delay(function(){M.$0.Post({$:7});return q.Zero();})),null);});else q.Start((X=null,q.Delay(function(){M.$0.Post({$:7});return q.Zero();})),null);Y=w.Create$1("");Z=w.Create$1("");_0=w.Create$1("");_1=w.Create$1("");_2=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","register-form")],U),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","register"),o.HandlerImpl("click",function(bh){return function(bi){return bg(bh,bi);};})],[n.TextNode("Register")])]);_3=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","tweetbox")],Z),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","tweetbtn"),o.HandlerImpl("click",function(bh){return function(bi){return ba(bh,bi);};})],[n.TextNode("Tweet")])]);_4=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","subscribebox")],_0),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","subscribebtn"),o.HandlerImpl("click",function(bh){return function(bi){return bb(bh,bi);};})],[n.TextNode("Subscribe")])]);_5=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","unsubscribebox")],Y),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","unsubscribebtn"),o.HandlerImpl("click",function(bh){return function(bi){return bc(bh,bi);};})],[n.TextNode("Unsubscribe")])]);_6=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","querybox")],_1),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","querybtn"),o.HandlerImpl("click",function(bh){return function(bi){return bd(bh,bi);};})],[n.TextNode("Query")])]);return n.Element("div",[],[_2,n.Element("div",[],[n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","login"),o.Create("style","display:none"),o.HandlerImpl("click",function(bh){return function(bi){return be(bh,bi);};})],[n.TextNode("Login")]),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","logout"),o.Create("style","display:none"),o.HandlerImpl("click",function(bh){return function(bi){return bf(bh,bi);};})],[n.TextNode("Logout")])]),_6,_4,_5,_3,O,N,R,Q,P,S]);};e.WebSocketLogin$163$30=a.id;e.WebSocketLogin$151$25=a.id;e.WebSocketLogin$145$26=a.id;e.WebSocketLogin=function(L){var M,N,O,P,Q,R,S;function T(X,Y){var Z;return q.Start((Z=null,q.Delay(function(){var _0,_1,_2,_3,_4,_5,_6,_7,_8,_9;M.$0.Post({$:5});_0=self.document.getElementById("login");_1=self.document.getElementById("logout");_2=self.document.getElementById("tweetbox");_3=self.document.getElementById("subscribebox");_4=self.document.getElementById("unsubscribebox");_5=self.document.getElementById("querybox");_6=self.document.getElementById("tweetbtn");_7=self.document.getElementById("subscribebtn");_8=self.document.getElementById("unsubscribebtn");_9=self.document.getElementById("querybtn");_2.removeAttribute("disabled");_3.removeAttribute("disabled");_4.removeAttribute("disabled");_5.removeAttribute("disabled");_6.removeAttribute("disabled");_7.removeAttribute("disabled");_8.removeAttribute("disabled");_9.removeAttribute("disabled");_0.removeAttribute("disabled");_1.removeAttribute("style");_0.setAttribute("display","none");return q.Zero();})),null);}function U(X,Y){var Z;return q.Start((Z=null,q.Delay(function(){var _0,_1,_2,_3,_4,_5,_6,_7,_8,_9;M.$0.Post({$:6});_0=self.document.getElementById("login");_1=self.document.getElementById("logout");_2=self.document.getElementById("tweetbox");_3=self.document.getElementById("subscribebox");_4=self.document.getElementById("unsubscribebox");_5=self.document.getElementById("querybox");_6=self.document.getElementById("tweetbtn");_7=self.document.getElementById("subscribebtn");_8=self.document.getElementById("unsubscribebtn");_9=self.document.getElementById("querybtn");_2.setAttribute("disabled","true");_3.setAttribute("disabled","true");_4.setAttribute("disabled","true");_5.setAttribute("disabled","true");_6.setAttribute("disabled","true");_7.setAttribute("disabled","true");_8.setAttribute("disabled","true");_9.setAttribute("disabled","true");_0.setAttribute("style","display:block");_1.setAttribute("style","display:none");_1.setAttribute("disabled","true");return q.Zero();})),null);}function V(){var X;X=self.document.getElementById("register");X.innerHTML="Account Registered";X.setAttribute("disabled","true");X.setAttribute("style","display:none");self.document.getElementById("logout").setAttribute("style","display:block");N.Set("Welcome to Twitter, @"+N.Get());self.document.getElementById("register-form").setAttribute("disabled","true");self.document.getElementById("logout").removeAttribute("disabled");}function W(X,Y){var Z;return q.Start((Z=null,q.Delay(function(){return r.Equals(M,null)?(function(_0){return _0("Trying to connect.");}(function(_0){v.log(_0);}),t.OfAsync(O).then(function(_0){M={$:1,$0:_0};(function(_1){return _1("Registering");}(function(_1){v.log(_1);}));return M.$0.Post({$:1,$0:N.Get()});}),q.Zero()):(M.$0.Post({$:1,$0:N.Get()}),q.Zero());})),null);}M=null;N=w.Create$1("");O=(P=null,q.Delay(function(){(function(X){return X("In here!");}(function(X){v.log(X);}));return z.ConnectStateful(function(X){return A.stringify((j.j())(X));},function(X){return(i.j())(A.parse(X));},L,function(){var X;X=null;return q.Delay(function(){return q.Return([0,function(Y){return function(Z){var _0;_0=null;return q.Delay(function(){var _1,_2;((function(_3){return function(_4){return _3("In in here here! "+k.p(_4));};}(function(_3){v.log(_3);}))(Z));return q.Combine(Z.$==0?(_1=Z.$0,_1.$==3?((function(_3){return function(_4){return _3("Success! "+u.toSafe(_4));};}(function(_3){v.log(_3);}))(_1.$0),q.Zero()):_1.$==4?(_2=_1.$0,((function(_3){return function(_4){return _3("Failure Login Page! "+u.toSafe(_4));};}(function(_3){v.log(_3);}))(_2),a.alert(_2),q.Zero())):_1.$==2?(V(),q.Zero()):_1.$==7?(function(_3){return _3("account retrieved from server");}(function(_3){v.log(_3);}),N.Set(_1.$0),q.Zero()):(function(_3){return _3("A message was sent back");}(function(_3){v.log(_3);}),q.Zero())):(function(_3){return _3("Failure");}(function(_3){v.log(_3);}),q.Zero()),q.Delay(function(){return q.Return(Y+1);}));});};}]);});});}));Q=n.Element("div",[],[n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","login"),o.Create("disabled","false"),o.HandlerImpl("click",function(X){return function(Y){return T(X,Y);};})],[n.Element("a",[o.Create("href","/home")],[n.TextNode("Login")])]),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","logout"),o.Create("style","display:none"),o.HandlerImpl("click",function(X){return function(Y){return U(X,Y);};})],[n.TextNode("Logout")])]);R=n.Element("div",[],[n.Input([o.Create("class","form-control"),o.Create("id","register-form")],N),n.Element("button",[o.Create("class","tweetBox__tweetButton"),o.Create("id","register"),o.HandlerImpl("click",function(X){return function(Y){return W(X,Y);};})],[n.TextNode("Register")])]);if(r.Equals(M,null))t.OfAsync(O).then(function(X){var Y;M={$:1,$0:X};(function(Z){return Z("Loading");}(function(Z){v.log(Z);}));return q.Start((Y=null,q.Delay(function(){M.$0.Post({$:7});return q.Zero();})),null);});else q.Start((S=null,q.Delay(function(){M.$0.Post({$:7});return q.Zero();})),null);return n.Element("div",[],[R,Q]);};g.New=function(L){return{Name:L};};h.Login=function(L,M){var N,O,P,Q,R,S;return(N=(O=(P=e.WebSocketLogin(M),(Q=new E.New$1(),(Q.h.push({$:0,$0:"websocketlogin",$1:P}),Q))),(O.h.push({$:1,$0:"homepagelink",$1:L}),O)),(R=F.CompleteHoles(N.k,N.h,[]),(S=new G.New(R[1],l.body(R[0])),N.i=S,S))).get_Doc();};h.Main=function(L,M){var N,O,P,Q,R,S;return(N=(O=(P=e.WebSocketTest(M),(Q=new E.New$1(),(Q.h.push({$:0,$0:"websockettest",$1:P}),Q))),(O.h.push({$:1,$0:"profilepagelink",$1:L}),O)),(R=F.CompleteHoles(N.k,N.h,[]),(S=new G.New(R[1],l.body$1(R[0])),N.i=S,S))).get_Doc();};i.j=function(){return i._v?i._v:i._v=(I.DecodeUnion(void 0,"$",[[0,[["$0","con",I.Id(),0]]],[1,[["$0","tweet",I.Id(),0]]],[2,[]],[3,[["$0","succ",I.Id(),0]]],[4,[["$0","fail",I.Id(),0]]],[5,[["$0","tweet",I.Id(),0]]],[6,[["$0","tweet",I.Id(),0]]],[7,[["$0","account",I.Id(),0]]]]))();};j.j=function(){return j._v?j._v:j._v=(I.EncodeUnion(void 0,"$",[[0,[["$0","tweet",I.Id(),0]]],[1,[["$0","account",I.Id(),0]]],[2,[["$0","userToSubTo",I.Id(),0]]],[3,[["$0","userToUnsubTo",I.Id(),0]]],[4,[["$0","query",I.Id(),0]]],[5,[]],[6,[]],[7,[]]]))();};k.p=function(L){return L.$==3?"Close":L.$==2?"Open":L.$==1?"Error":"Message "+k.p$1(L.$0);};k.p$1=function(L){return L.$==7?"CurrentAccount "+u.prettyPrint(L.$0):L.$==6?"MissedTweet "+u.prettyPrint(L.$0):L.$==5?"QueryFromServer "+u.prettyPrint(L.$0):L.$==4?"Failure "+u.prettyPrint(L.$0):L.$==3?"Success "+u.prettyPrint(L.$0):L.$==2?"RegisteredFromServer":L.$==1?"TweetFromServer "+u.prettyPrint(L.$0):"Connection "+u.prettyPrint(L.$0);};l.body=function(L){K.LoadLocalTemplates("login");return L?K.NamedTemplate("login",{$:1,$0:"body"},L):void 0;};l.body$1=function(L){K.LoadLocalTemplates("main");return L?K.NamedTemplate("main",{$:1,$0:"body"},L):void 0;};}(self));
